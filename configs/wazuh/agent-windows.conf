# Wazuh Agent Configuration â€” Windows VMs (dc01 and win11)
# 
# Add these <localfile> blocks to:
#   C:\Program Files (x86)\ossec-agent\ossec.conf
# 
# Add inside the <ossec_config> block.
# After editing: NET STOP Wazuh && NET START Wazuh

<!-- Sysmon events - process creation, network connections, registry -->
<localfile>
  <location>Microsoft-Windows-Sysmon/Operational</location>
  <log_format>eventchannel</log_format>
</localfile>

<!-- Security events - logon, auth, privilege use, object access -->
<localfile>
  <location>Security</location>
  <log_format>eventchannel</log_format>
</localfile>

<!-- System events - service installs (Event 7045), crashes -->
<localfile>
  <location>System</location>
  <log_format>eventchannel</log_format>
</localfile>

<!-- Application events - optional but useful -->
<localfile>
  <location>Application</location>
  <log_format>eventchannel</log_format>
</localfile>

# -----------------------------------------------------------------------
# Make sure Sysmon is installed BEFORE adding these localfile entries.
# If Sysmon is not installed, Wazuh agent will log an error for the
# Sysmon channel and skip it (it won't crash, but you'll miss events).
#
# Sysmon install (PowerShell as Administrator):
#   C:\Sysmon\Sysmon64.exe -accepteula -i C:\Sysmon\sysmonconfig.xml
#
# Verify Sysmon running:
#   Get-Service sysmon64  # Expected: Running
# -----------------------------------------------------------------------
